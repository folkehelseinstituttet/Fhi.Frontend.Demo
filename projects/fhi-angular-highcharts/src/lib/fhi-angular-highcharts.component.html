<ng-container *ngIf="diagramOptions !== undefined">
  <ng-container *ngIf="diagramOptions.diagramTypeNav !== undefined">
    <ng-container *ngTemplateOutlet="diagramTypeNav"></ng-container>
  </ng-container>

  <ng-container [ngSwitch]="currentDiagramTypeGroup">
    <ng-container *ngSwitchCase="diagramTypeGroups.table">
      <ng-container *ngTemplateOutlet="table"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="diagramTypeGroups.map">
      <ng-container *ngIf="allMapsLoaded">
        <ng-container *ngTemplateOutlet="map"></ng-container>
      </ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="diagramTypeGroups.chart">
      <ng-container *ngIf="showDefaultChartTemplate; else chartAnimationHack">
        <ng-container *ngTemplateOutlet="chart"></ng-container>
      </ng-container>
      <ng-template #chartAnimationHack><!-- to get correct chart animation when switching from one chart type to another -->
        <ng-container *ngTemplateOutlet="chart"></ng-container>
      </ng-template>
    </ng-container>
  </ng-container>
</ng-container>


<ng-template #diagramTypeNav>
  <fhi-diagram-type-nav
    *ngIf="diagramOptions.diagramTypeNav === diagramTypeNavs.default"
    [currentDiagramTypeGroup]="currentDiagramTypeGroup"
    [currentDiagramType]="diagramOptions.diagramType"
    (navigateToDiagramType)="onDiagramTypeNav($event)">
  </fhi-diagram-type-nav>
</ng-template>

<ng-template #chart>
  <highcharts-chart
    class="fhi-highcharts-chart"
    [Highcharts]="Highcharts"
    [options]="options"
    (chartInstance)="onChartInstance($event)">
  </highcharts-chart>
</ng-template>

<ng-template #map>
  <highcharts-chart
    class="fhi-highcharts-map"
    [Highcharts]="Highcharts"
    [constructorType]="'mapChart'"
    [options]="options"
    (chartInstance)="onChartInstance($event)">
  </highcharts-chart>
</ng-template>

<ng-template #table>
  <article class="fhi-highcharts-table">
    <h1 class="h4">{{ tableTitle }}</h1>
    <div class="table-responsive">
      <table class="table table-striped table-sm mt-3">
        <thead>
          <tr class="fhi-highcharts-table__row">
            <th *ngFor="let tableCellData of tableHeaderRow; let i = index"
                [scope]="i === 0 ? 'row' : 'col'"
                class="fhi-highcharts-table__cell fhi-highcharts-table__cell--header">
              <span>{{ tableCellData }}</span>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let tableRow of tableBodyRows" class="fhi-highcharts-table__row">
            <ng-container *ngFor="let tableCellData of tableRow; let i = index">
              <th *ngIf="i === 0" scope="row" class="fhi-highcharts-table__cell">{{ tableCellData }}</th>
              <td class="fhi-highcharts-table__cell" *ngIf="i !== 0">{{ tableCellData | number }}</td>
            </ng-container>
          </tr>
        </tbody>
      </table>
    </div>
    <footer class="fhi-highcharts-table__footer">
      <div class="fhi-highcharts-table__caption">
        <p class="fhi-highcharts-table__caption-last-update mb-0"
           *ngIf="tableLastUpdated">Oppdatert: {{ tableLastUpdated }}</p>
        <p class="fhi-highcharts-table__caption-disclaimer mb-0"
           *ngIf="tableDisclaimer"
           [innerHTML]="tableDisclaimer">
        </p>
        <a href="{{ tableCreditsHref }}" class="fhi-highcharts-table__credits">{{ tableCreditsText }}</a>
      </div>
    </footer>
  </article>
</ng-template>
