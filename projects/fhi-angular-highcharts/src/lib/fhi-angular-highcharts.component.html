<ng-container *ngIf="diagramOptions.diagramTypeMenu">
  <ng-container *ngTemplateOutlet="diagramTypeMenu"></ng-container>
</ng-container>

<ng-container [ngSwitch]="currentDiagramTemplate">
  <ng-container *ngSwitchCase="diagramTemplates.table">
    <ng-container *ngTemplateOutlet="table"></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="diagramTemplates.map">
    <ng-container *ngIf="allMapsLoaded">
      <ng-container *ngTemplateOutlet="map"></ng-container>
    </ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="diagramTemplates.chart">
    <ng-container *ngIf="showDefaultChartTemplate; else chartAnimationHack">
      <ng-container *ngTemplateOutlet="chart"></ng-container>
    </ng-container>
    <ng-template #chartAnimationHack><!-- to get correct chart animation when switching from one chart type to another -->
      <ng-container *ngTemplateOutlet="chart"></ng-container>
    </ng-template>
  </ng-container>
</ng-container>


<ng-template #diagramTypeMenu>
  <div class="fhi-highcharts-btn-group mb-3">
    <div class="btn-group fhi-btn-group mb-1" role="group" aria-label="Visningsvalg">
      <ng-container *ngFor="let navigationElement of navigationMenu; index as i">
        <input class="btn-check fhi-btn-group__check"
               type="radio"
               name="visualisationNavigation"
               aria-controls="chartTypeMenu"
               [id]="'navElm' + i"
               [checked]="i === 0"
               [attr.aria-haspopup]="navigationElement.hasChartTypes"
               (change)="chartIsActive = navigationElement.hasChartTypes">
        <label [for]="'navElm' + i" class="btn fhi-btn-group__btn">
          <i class="icon-md" [ngClass]="navigationElement.icon !== null ? 'icon-' + navigationElement.icon : 'icon-' + currentChartType"></i>
          {{ navigationElement.name }}
        </label>
      </ng-container>
    </div>

    <div class="btn-group fhi-btn-group fhi-highcharts-btn-group__chart-type mb-1"
         id="chartTypeMenu"
         role="menu"
         aria-label="Velg graftype"
         *ngIf="chartIsActive">
      <ng-container *ngFor="let chartType of chartTypes; index as i">
        <input class="btn-check fhi-btn-group__check"
               type="radio"
               name="charttype"
               (change)="changeChartType(chartType.icon)"
               [id]="'charttype' + i"
               [checked]="chartType.icon === currentChartType">
        <label class="btn fhi-btn-group__btn border-0"
               [for]="'charttype' + i">
          <i [class]="'icon-md icon-' + chartType.icon"></i>
          <span class="visually-hidden">{{ chartType.name }}</span>
        </label>
      </ng-container>
    </div>
  </div>
</ng-template>

<ng-template #chart>
  <highcharts-chart
    class="fhi-highcharts"
    [Highcharts]="Highcharts"
    [options]="options"
    (chartInstance)="onChartInstance($event)">
  </highcharts-chart>
</ng-template>

<ng-template #map>
  <highcharts-chart
    class="fhi-highcharts fhi-highcharts-map"
    [Highcharts]="Highcharts"
    [constructorType]="'mapChart'"
    [options]="options"
    (chartInstance)="onChartInstance($event)">
  </highcharts-chart>
</ng-template>

<ng-template #table>
  <article class="fhi-highcharts-table">
    <h1 class="h3">{{ tableTitle }}</h1>
    <div class="table-responsive">
      <table class="table table-striped table-sm mt-3">
        <thead>
          <tr class="fhi-highcharts-table__row">
            <th *ngFor="let tableCellData of tableHeaderRow; let i = index"
                [scope]="i === 0 ? 'row' : 'col'"
                class="fhi-highcharts-table__cell fhi-highcharts-table__cell--header text-center">
              <span>{{ tableCellData }}</span>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let tableRow of tableBodyRows" class="fhi-highcharts-table__row">
            <ng-container *ngFor="let tableCellData of tableRow; let i = index">
              <th *ngIf="i === 0" scope="row" class="fhi-highcharts-table__cell">{{ tableCellData }}</th>
              <td class="fhi-highcharts-table__cell text-right" *ngIf="i !== 0">{{ tableCellData | number }}</td>
            </ng-container>
          </tr>
        </tbody>
      </table>
    </div>
    <footer class="fhi-highcharts-table__footer">
      <div class="fhi-highcharts-table__caption">
        <p class="fhi-highcharts-table__caption-last-update mb-0"
           *ngIf="tableLastUpdated">Oppdatert: {{ tableLastUpdated }}</p>
        <p class="fhi-highcharts-table__caption-disclaimer mb-0"
           *ngIf="tableDisclaimer"
           [innerHTML]="tableDisclaimer">
        </p>
        <a href="{{ tableCreditsHref }}" class="fhi-highcharts-table__credits">{{ tableCreditsText }}</a>
      </div>
    </footer>
  </article>
</ng-template>
